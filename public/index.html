<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
        integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>Quote API</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <div class="'headerContainer">
            <h1>Quote API</h1>
        </div>
    </div>

    <section>
        <h2 class=""subHeader>Description</h2>
        <div class="info">
            <h3>Purpose</h3>
            <p>To receive weekly inspiring quotes from your favorite scientists and engineers!</p>
        </div>
    </section>

    <section>
        <h2 class="subHeader">Subscribe for quotes</h2>
        <p class="preMsg">Join Quote API and subscribe to weekly newsletter</p>
        <p class="errMsg">Please ensure your email address is formatted correctly</p>
        <p class="subMsg">You Are Subscribed!</p>
        <div class="keyInput">
            <input id="userEmail" type="email" placeholder="Enter your email" />
        </div>
        <div id="signup_btn" class="addKey">
            <i class="fa-solid fa-check"></i>Subscribe
        </div>
    </section>

    <section>
        <h2 class="subHeader">Submit a quote</h2>
        <p class="preMsg">Share your favorite quote with the world!</p>
        <p class="subMsg">Quote Submitted!</p>
        <div class="info">
            <h3>Example Quote</h3>
            <p>"The most fruitful research grows out of practical problems." -Peck, R.B. (Geotechnical Eng.)</p>
        </div>
        <form method="POST">
            <input type="text" placeholder="Quote" />
            <input type="text" placeholder="Author (Peck, R.B.)" />
            <input type="text" placeholder="Field" />
            <input type="text" placeholder="Source" />
        </form>
        <div>
            <i class="fa-solid fa-check"></i>Share
        </div>
    </section>

    <section>
        <p>Buy Me a Coffee</p>
    </section>

</body>

<footer>
    <div class="container">
        <div class="footerContainer">
            <a class="first" href="https://github.com/liangchow" target="_blank">
                <i class="fa-regular fa-circle-question"></i>
            </a> 
        </div>
    </div>
</footer>

<script>
    const input = document.getElementById('userEmail')
    const signup_btn = document.getElementById('signup_btn')
    const errMsg = document.querySelector('.errMsg')
    const subMsg = document.querySelector('.subMsg')

    async function signupNewUser(){
        const user_email = input.value.trim()
  
        if (!user_email || !input.checkValidity()){
            errMsg.style.display = 'inline'
            return
        }
        try {
            const res = await fetch('/signup', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: user_email })
            })
            // if (!res.ok){
            //     errMsg.style.display = 'inline'
            //     return
            // }
            subMsg.style.display = 'inline'
            input.value = ''
        } catch(err){
            errMsg.style.display = 'inline'
        }
    }

    signup_btn.addEventListener('click', signupNewUser)
</script>    

</html>
